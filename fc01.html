<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Daily Fortune Cookie</title>
  <meta name="description" content="Tap the cookie. Receive one message." />
  <style>
    :root{
      --bg-night-1:#070814;
      --bg-night-2:#0b0f2a;
      --bg-sky-1:#9fd8ff;
      --bg-sky-2:#e8f6ff;

      --text:#f3f4f6;
      --ink:#111827;

      --paper:#fffdf7;
      --paper-edge:#e9e2d3;

      --cookie:#c99a57;
      --cookie-dark:#a7743a;
      --cookie-line: rgba(0,0,0,.18);
      --shadow: rgba(0,0,0,.25);

      --radius: 18px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    body{
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      color:var(--text);
      background: radial-gradient(1200px 800px at 50% 30%, var(--bg-night-2), var(--bg-night-1));
      transition: background 900ms ease;
    }

    /* Subtle ‚Äústar glitter‚Äù */
    .stars{
      position:absolute; inset:-20%;
      pointer-events:none;
      opacity:.65;
      filter: blur(.2px);
      background:
        radial-gradient(2px 2px at 10% 20%, rgba(255,255,255,.9), transparent 60%),
        radial-gradient(1px 1px at 35% 65%, rgba(255,255,255,.7), transparent 60%),
        radial-gradient(1.5px 1.5px at 60% 30%, rgba(255,255,255,.8), transparent 60%),
        radial-gradient(1px 1px at 80% 55%, rgba(255,255,255,.6), transparent 60%),
        radial-gradient(2px 2px at 72% 18%, rgba(255,255,255,.75), transparent 60%),
        radial-gradient(1px 1px at 18% 78%, rgba(255,255,255,.65), transparent 60%),
        radial-gradient(1.5px 1.5px at 90% 85%, rgba(255,255,255,.8), transparent 60%);
      animation: twinkle 6s ease-in-out infinite;
    }
    @keyframes twinkle{
      0%,100%{ opacity:.45; transform: translateY(0px) scale(1); }
      50%{ opacity:.8; transform: translateY(-6px) scale(1.01); }
    }

    /* Main container */
    .wrap{
      position:relative;
      width:min(560px, 92vw);
      padding: 26px 18px 22px;
      text-align:center;
      z-index:2;
    }

    .title{
      font-weight:600;
      letter-spacing:.2px;
      margin:0 0 8px;
      font-size: clamp(18px, 2.4vw, 22px);
      opacity:.92;
    }
    .subtitle{
      margin:0 0 16px;
      font-size: 13px;
      opacity:.78;
    }

    /* Cookie button */
    .cookieBtn{
      border:0;
      background: transparent;
      cursor:pointer;
      padding: 0;
      outline:none;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
      touch-action: manipulation;
    }
    .cookieStage{
      width:min(220px, 60vw);
      height:min(220px, 60vw);
      margin: 0 auto 10px;
      position:relative;
      filter: drop-shadow(0 18px 24px var(--shadow));
    }

    /* Cookie: simple vector-like shape */
    .cookie{
      position:absolute;
      inset: 18px;
      border-radius: 48% 52% 50% 50% / 52% 48% 52% 48%;
      background:
        radial-gradient(120px 120px at 35% 35%, rgba(255,255,255,.22), transparent 60%),
        radial-gradient(140px 120px at 55% 65%, rgba(0,0,0,.15), transparent 60%),
        linear-gradient(135deg, var(--cookie), var(--cookie-dark));
    }
    .cookie::before{
      content:"";
      position:absolute;
      inset: 18% 12%;
      border-radius: 60% 40% 50% 50% / 50% 50% 50% 50%;
      border: 2px solid rgba(255,255,255,.14);
      opacity:.55;
    }
    .cookie::after{
      content:"";
      position:absolute;
      inset: 0;
      border-radius: inherit;
      background:
        radial-gradient(2px 2px at 22% 35%, var(--cookie-line), transparent 60%),
        radial-gradient(2px 2px at 48% 28%, var(--cookie-line), transparent 60%),
        radial-gradient(2px 2px at 70% 40%, var(--cookie-line), transparent 60%),
        radial-gradient(2px 2px at 35% 60%, var(--cookie-line), transparent 60%),
        radial-gradient(2px 2px at 62% 72%, var(--cookie-line), transparent 60%);
      opacity:.55;
    }

    /* Broken cookie (two halves) */
    .half{
      position:absolute;
      inset: 18px;
      border-radius: 48% 52% 50% 50% / 52% 48% 52% 48%;
      background:
        radial-gradient(120px 120px at 35% 35%, rgba(255,255,255,.22), transparent 60%),
        radial-gradient(140px 120px at 55% 65%, rgba(0,0,0,.15), transparent 60%),
        linear-gradient(135deg, var(--cookie), var(--cookie-dark));
      opacity:0;
      transform: scale(.96);
      transition: transform 700ms ease, opacity 420ms ease;
    }
    .half.left{
      clip-path: polygon(0% 0%, 57% 0%, 49% 100%, 0% 100%);
      transform: translateX(0px) rotate(0deg) scale(.96);
    }
    .half.right{
      clip-path: polygon(43% 0%, 100% 0%, 100% 100%, 51% 100%);
      transform: translateX(0px) rotate(0deg) scale(.96);
    }
    .crack{
      position:absolute;
      left:50%;
      top:20%;
      width: 6px;
      height: 60%;
      transform: translateX(-50%);
      background: rgba(0,0,0,.12);
      border-radius: 99px;
      opacity:0;
      transition: opacity 220ms ease;
    }

    /* Paper */
    .paper{
      position: relative;
      margin: 14px auto 0;
      width: min(460px, 92vw);
      background: linear-gradient(180deg, var(--paper), #fff);
      color: var(--ink);
      border-radius: var(--radius);
      border: 1px solid rgba(17,24,39,.12);
      box-shadow: 0 18px 32px rgba(0,0,0,.18);
      padding: 18px 16px;
      opacity: 0;
      transform: translateY(10px) scale(.98);
      transition: opacity 520ms ease, transform 520ms ease;
    }
    .paper::before{
      content:"";
      position:absolute;
      inset: 0;
      border-radius: inherit;
      background:
        linear-gradient(90deg, rgba(0,0,0,.05), transparent 18%, transparent 82%, rgba(0,0,0,.05));
      pointer-events:none;
      opacity:.5;
    }
    .paperTop{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      margin-bottom: 8px;
    }
    .badge{
      font-size:12px;
      letter-spacing:.8px;
      text-transform:uppercase;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(17,24,39,.06);
      border: 1px solid rgba(17,24,39,.10);
    }
    .fortune{
      font-size: clamp(16px, 2.4vw, 18px);
      line-height: 1.5;
      margin: 8px 0 0;
      padding: 0 6px;
      font-weight: 500;
    }

    .hint{
      margin-top: 10px;
      font-size: 12px;
      opacity: .74;
    }

    /* Sound toggle */
    .soundRow{
      display:flex;
      justify-content:center;
      gap:10px;
      margin-top: 10px;
      opacity:.9;
    }
    .soundBtn{
      border: 1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 8px 10px;
      border-radius: 999px;
      font-size: 12px;
      cursor:pointer;
      user-select:none;
    }
    .soundBtn[aria-pressed="true"]{
      background: rgba(255,255,255,.14);
      border-color: rgba(255,255,255,.32);
    }

    /* ‚ÄúOpened‚Äù state */
    body.opened{
      background: radial-gradient(1000px 720px at 50% 20%, var(--bg-sky-2), var(--bg-sky-1));
      color: var(--ink);
    }
    body.opened .stars{ opacity:0; transition: opacity 500ms ease; }
    body.opened .subtitle{ opacity:.7; color: rgba(17,24,39,.75); }
    body.opened .soundBtn{
      border-color: rgba(17,24,39,.14);
      background: rgba(17,24,39,.06);
      color: var(--ink);
    }
    body.opened .soundBtn[aria-pressed="true"]{
      background: rgba(17,24,39,.12);
      border-color: rgba(17,24,39,.18);
    }

    body.opened .cookie{ opacity:0; transition: opacity 240ms ease; }
    body.opened .half{ opacity:1; }
    body.opened .half.left{ transform: translateX(-26px) rotate(-10deg) scale(1); }
    body.opened .half.right{ transform: translateX(26px) rotate(10deg) scale(1); }
    body.opened .crack{ opacity:1; }

    body.opened .paper{
      opacity:1;
      transform: translateY(0px) scale(1);
    }

    /* Reduce motion accessibility */
    @media (prefers-reduced-motion: reduce){
      *{ animation:none !important; transition:none !important; }
    }
  </style>
</head>
<body>
  <div class="stars" aria-hidden="true"></div>

  <main class="wrap">
    <h1 class="title">Your Daily Cookie</h1>
    <p class="subtitle">Tap once. Receive one message.</p>

    <button class="cookieBtn" id="cookieBtn" aria-label="Open the fortune cookie">
      <div class="cookieStage" role="img" aria-label="Fortune cookie">
        <div class="cookie" aria-hidden="true"></div>

        <div class="half left" aria-hidden="true"></div>
        <div class="half right" aria-hidden="true"></div>
        <div class="crack" aria-hidden="true"></div>
      </div>
    </button>

    <div class="soundRow">
      <button class="soundBtn" id="soundBtn" type="button" aria-pressed="true" title="Toggle sound">
        üîä Sound: ON
      </button>
    </div>

    <section class="paper" id="paper" aria-live="polite" aria-atomic="true">
      <div class="paperTop">
        <span class="badge" id="badge">Fortune #01</span>
      </div>
      <p class="fortune" id="fortuneText">
        <!-- Message injected by JS -->
      </p>
      <div class="hint">Refresh won‚Äôt change this message.</div>
    </section>

    <!-- Audio: replace file names with your own files placed in same folder -->
    <audio id="audioCrack" preload="auto" src="cookie-crack.mp3"></audio>
    <audio id="audioPaper" preload="auto" src="paper-rustle.mp3"></audio>
  </main>

  <script>
    // ====== CONFIG (Fortune-01) ======
    const FORTUNE_ID = "01";
    const FORTUNE_TEXT = "Your lucky break is closer than you think";

    // ====== State ======
    const cookieBtn = document.getElementById("cookieBtn");
    const paper = document.getElementById("paper");
    const fortuneTextEl = document.getElementById("fortuneText");
    const badgeEl = document.getElementById("badge");

    const soundBtn = document.getElementById("soundBtn");
    const audioCrack = document.getElementById("audioCrack");
    const audioPaper = document.getElementById("audioPaper");

    let opened = false;
    let soundEnabled = true;

    // Inject message (static, not random)
    badgeEl.textContent = `Fortune #${FORTUNE_ID}`;
    fortuneTextEl.textContent = FORTUNE_TEXT;

    // Sound toggle
    soundBtn.addEventListener("click", () => {
      soundEnabled = !soundEnabled;
      soundBtn.setAttribute("aria-pressed", String(soundEnabled));
      soundBtn.textContent = soundEnabled ? "üîä Sound: ON" : "üîá Sound: OFF";
    });

    function safePlay(audioEl){
      if(!soundEnabled) return;
      if(!audioEl) return;

      try{
        audioEl.currentTime = 0;
        const p = audioEl.play();
        // Some browsers return a promise that can reject if autoplay is blocked.
        if(p && typeof p.catch === "function"){
          p.catch(() => {
            // If blocked, user can toggle sound or tap again; we keep it silent.
          });
        }
      }catch(e){
        // ignore
      }
    }

    cookieBtn.addEventListener("click", () => {
      if(opened) return;
      opened = true;

      // Visual transition
      document.body.classList.add("opened");

      // Audio: crack first, then paper slightly later
      safePlay(audioCrack);
      setTimeout(() => safePlay(audioPaper), 420);

      // Accessibility: focus the revealed content
      setTimeout(() => {
        paper.scrollIntoView({ behavior: "smooth", block: "center" });
      }, 650);
    });

    // Optional: allow keyboard open (Enter/Space already works on button)
  </script>
</body>
</html>
